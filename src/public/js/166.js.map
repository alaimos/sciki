{"version":3,"sources":["webpack:///./resources/js/Components/Layout/Headers/DefaultHeader.tsx","webpack:///./resources/js/Components/TagsManagerCard.tsx","webpack:///./resources/js/Components/Wiki/AutoLinksParser.ts","webpack:///./resources/js/Contexts/EditorRefProvider.tsx","webpack:///./resources/js/Components/Wiki/Editor.tsx","webpack:///./resources/css/Components/Wiki/MediaManager.css?93c4","webpack:///./resources/js/Components/Wiki/MediaManager.tsx","webpack:///./resources/js/Pages/Pages/Edit.tsx","webpack:///./resources/css/Components/Wiki/MediaManager.css","webpack:////home/alaimos/repos/sciki/src/node_modules/moment-mini/locale|sync|/^\\.\\/.*$/"],"names":["headerBg","title","className","fluid","lg","md","tags","errors","onAddTag","onDeleteTag","dark","typeAheadRef","useRef","useState","isLoading","setIsLoading","tagInputValue","setTagInputValue","tagInputOptions","setTagInputOptions","doAddTag","newTag","newTagParts","split","length","join","current","clear","shadow","style","height","map","tag","key","href","onClick","e","preventDefault","filterBy","id","options","onSearch","query","response","data","onChange","selected","onKeyDown","re","code","target","value","minLength","placeholder","ref","allowNew","addonType","values","label","getTextTag","trimUnmatchedTrailingParens","source","trailingParen","exec","count","ch","trimCount","Math","min","substring","trimTrailingEntity","replace","m","reWwwAutolink","RegExp","result","text","scheme","push","range","index","url","parseUrlLink","reEmailLink","test","parseEmailLink","rePageLink","parseSciKiPageLink","sort","a","b","EditorRefContext","useEditorRefContext","useContext","children","Provider","katexPlugin","editor","setCodeBlockLanguages","Object","getPrototypeOf","constructor","setReplacer","codeBlockContent","throwOnError","mermaidPlugin","randomId","random","toString","substr","document","querySelector","remove","message","scikiPlugin","JSON","parse","setTimeout","container","expanded","innerHTML","scikiExtendedMarkdownPlugin","pluginFn","eventManager","addEventType","listen","insertText","getUI","getToolbar","addItem","type","event","tooltip","popup","createPopup","header","content","modal","el","css","width","position","isShow","hide","emit","show","refTextBox","noteTextBox","addCommand","name","mde","note","cm","getEditor","oldCursor","getCursor","moveCursorToEnd","setCursor","addEventListener","renderer","codeBlock","node","parsed","origin","info","textNode","jsonData","tagName","classNames","attributes","media","caption","parser","image","destination","startsWith","endsWith","orgDestination","link","editorRef","initialValue","previewStyle","initialEditType","useCommandShortcut","usageStatistics","hideModeSwitch","extendedAutolinks","getInstance","getMarkdown","plugins","hljs","currentPageSlug","enableFeatured","featuredId","deletedMedia","onMediaUpload","onMediaUpdate","onMediaSelect","onFeaturedSelect","onMediaDelete","isFeaturedEnabled","titleRef","legendRef","uppy","instance","Uppy","restrictions","allowedFileTypes","use","fieldName","endpoint","headers","accept","getResponseError","responseText","jsonResponse","status","file","Array","isArray","Error","quality","on","_","body","uploadOpen","setUploadOpen","open","editState","setEditState","toggleEdit","prevState","setProcessing","processing","Row","Col","Card","CardHeader","CardBody","maxHeight","filter","includes","uuid","background","thumbs","large","CopyToClipboard","UncontrolledTooltip","placement","closeModalOnClickOutside","onRequestClose","fileManagerSelectionType","theme","Modal","isOpen","toggle","FormGroup","Label","for","Input","innerRef","invalid","defaultValue","FormFeedback","legend","Button","color","disabled","Index","page","slug","draft","featured_image_id","setData","put","submitForm","Form","onSubmit","row","sm","fontSize","Container","Nav","pills","NavItem","NavLink","Inertia","xl","newContent","TagsManagerCard","previousData","t","deletedTag","mediaText","updatedMedia","tmpData","newMedia","props","___CSS_LOADER_EXPORT___","module","webpackContext","req","webpackContextResolve","__webpack_require__","o","keys","resolve","exports"],"mappings":"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","file":"js/166.js?id=cfc28fe5a92faed85880","sourcesContent":["import React from \"react\";\nimport { Container, Row, Col } from \"reactstrap\";\n\ninterface Props {\n    headerBg?: string;\n    title?: React.ReactNode;\n}\n\nconst DefaultHeader: React.FC<Props> = ({ headerBg, title }: Props) => {\n    return (\n        <>\n            <div\n                className={`header pb-8 pt-5 pt-lg-8 d-flex align-items-center ${\n                    headerBg ?? \"bg-gradient-gray-dark\"\n                }`}\n            >\n                <Container\n                    className=\"d-flex align-items-center flex-grow-1\"\n                    fluid\n                >\n                    <Row className=\"flex-grow-1\">\n                        <Col lg=\"7\" md=\"10\">\n                            <h1 className=\"display-2 text-white\">\n                                {title ?? \" \"}\n                            </h1>\n                        </Col>\n                    </Row>\n                </Container>\n            </div>\n        </>\n    );\n};\n\nexport default DefaultHeader;\n","import React, { useRef, useState } from \"react\";\nimport {\n    Badge,\n    Card,\n    CardBody,\n    CardHeader,\n    Col,\n    InputGroup,\n    InputGroupAddon,\n    InputGroupText,\n    Row,\n} from \"reactstrap\";\nimport classNames from \"classnames\";\nimport { AsyncTypeahead } from \"react-bootstrap-typeahead\";\nimport axios from \"axios\";\nimport route from \"ziggy-js\";\n\nimport \"react-bootstrap-typeahead/css/Typeahead.css\";\n\ninterface Props {\n    tags: string[];\n    errors?: string;\n    onAddTag: (newTag: string) => void;\n    onDeleteTag: (deletedTag: string) => void;\n    dark?: boolean;\n}\n\ntype TypeAheadOption =\n    | string\n    | {\n          customOption: boolean;\n          label: string;\n          id: string;\n      };\n\nconst TagsManagerCard: React.FC<Props> = ({\n    tags,\n    errors,\n    onAddTag,\n    onDeleteTag,\n    dark = true,\n}: Props) => {\n    const typeAheadRef = useRef<AsyncTypeahead<TypeAheadOption>>(null);\n    const [isLoading, setIsLoading] = useState(false);\n    const [tagInputValue, setTagInputValue] = useState<TypeAheadOption[]>([]);\n    const [tagInputOptions, setTagInputOptions] = useState<string[]>([]);\n\n    const getTextTag = (values: TypeAheadOption[]) => {\n        if (values.length > 0) {\n            if (typeof values[0] === \"object\") {\n                return values[0].label;\n            } else if (typeof values[0] === \"string\") {\n                return values[0];\n            }\n        }\n        return undefined;\n    };\n\n    const doAddTag = (newTag?: string) => {\n        if (newTag) {\n            const newTagParts = newTag.split(/:\\s*/, 2);\n            onAddTag(\n                newTagParts.length === 1\n                    ? `unknown: ${newTagParts[0]}`\n                    : newTagParts.join(\": \")\n            );\n            // @ts-ignore\n            typeAheadRef.current?.clear();\n        }\n    };\n\n    const handleSearch = async (query: string) => {\n        setIsLoading(true);\n        try {\n            const response = await axios.post(route(\"tag.typeahead\"), {\n                query,\n            });\n            setTagInputOptions(response.data as string[]);\n        } catch (_) {\n            setTagInputOptions([]);\n        }\n        setIsLoading(false);\n    };\n\n    return (\n        <Card\n            className={classNames({ \"bg-gradient-dark\": dark, shadow: true })}\n        >\n            <CardHeader className=\"bg-transparent\">\n                <h6 className=\"text-uppercase text-light ls-1 mb-1\">Tags</h6>\n            </CardHeader>\n            <CardBody>\n                <Row>\n                    <Col style={{ height: \"100px\" }} className=\"overflow-auto\">\n                        {tags.map((tag) => (\n                            <Badge\n                                key={tag}\n                                className=\"badge-default mx-1 text-light\"\n                                href=\"#\"\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    onDeleteTag(tag);\n                                }}\n                                title=\"Click to delete\"\n                            >\n                                {tag}\n                            </Badge>\n                        ))}\n                    </Col>\n                </Row>\n                <Row>\n                    <Col>\n                        {!!errors && (\n                            <div className=\"invalid-feedback d-block\">\n                                <strong>{errors}</strong>\n                            </div>\n                        )}\n                    </Col>\n                </Row>\n                <Row className=\"mt-2\">\n                    <Col>\n                        <InputGroup>\n                            <AsyncTypeahead<TypeAheadOption>\n                                filterBy={() => true}\n                                id=\"tags-manager-add-tag-input\"\n                                isLoading={isLoading}\n                                options={tagInputOptions}\n                                onSearch={handleSearch}\n                                onChange={(selected: TypeAheadOption[]) =>\n                                    setTagInputValue(selected)\n                                }\n                                onKeyDown={(e) => {\n                                    const re =\n                                        e as unknown as React.KeyboardEvent<HTMLInputElement>;\n                                    if (\n                                        re.code === \"Enter\" ||\n                                        re.code === \"NumpadEnter\"\n                                    ) {\n                                        // @ts-ignore\n                                        doAddTag(re.target.value);\n                                        // @ts-ignore\n                                        typeAheadRef.current?.clear();\n                                    }\n                                }}\n                                selected={tagInputValue}\n                                minLength={3}\n                                className=\"text-dark\"\n                                placeholder=\"Add new tag (category: tag)\"\n                                ref={typeAheadRef}\n                                allowNew\n                            />\n                            <InputGroupAddon addonType=\"append\">\n                                <InputGroupText>\n                                    <a\n                                        className=\"text-primary\"\n                                        href=\"#\"\n                                        onClick={(e) => {\n                                            e.preventDefault();\n                                            doAddTag(getTextTag(tagInputValue));\n                                        }}\n                                    >\n                                        <i className=\"fas fa-plus\" />\n                                    </a>\n                                </InputGroupText>\n                            </InputGroupAddon>\n                        </InputGroup>\n                    </Col>\n                </Row>\n            </CardBody>\n        </Card>\n    );\n};\n\nexport default TagsManagerCard;\n","import AutolinkParser = toastui.AutolinkParser;\nimport route from \"ziggy-js\";\n\nconst DOMAIN = \"(?:[w-]+.)*[A-Za-z0-9-]+.[A-Za-z0-9-]+\";\nconst PATH = \"[^<\\\\s]*[^<?!.,:*_?~\\\\s]\";\nconst EMAIL = \"[\\\\w.+-]+@(?:[\\\\w-]+\\\\.)+[\\\\w-]+\";\n\nfunction trimUnmatchedTrailingParens(source: string) {\n    const trailingParen = /\\)+$/.exec(source);\n    if (trailingParen) {\n        let count = 0;\n        for (const ch of source) {\n            if (ch === \"(\") {\n                if (count < 0) {\n                    count = 1;\n                } else {\n                    count += 1;\n                }\n            } else if (ch === \")\") {\n                count -= 1;\n            }\n        }\n\n        if (count < 0) {\n            const trimCount = Math.min(-count, trailingParen[0].length);\n            return source.substring(0, source.length - trimCount);\n        }\n    }\n    return source;\n}\n\nfunction trimTrailingEntity(source: string) {\n    return source.replace(/&[A-Za-z0-9]+;$/, \"\");\n}\n\ninterface LinkInfo {\n    text: string;\n    url: string;\n    range: [number, number];\n}\n\nfunction parseEmailLink(source: string): LinkInfo[] {\n    const reEmailLink = new RegExp(EMAIL, \"g\");\n    const result: LinkInfo[] = [];\n    let m;\n    while ((m = reEmailLink.exec(source))) {\n        const text = m[0];\n        if (!/[_-]+$/.test(text)) {\n            result.push({\n                text,\n                range: [m.index, m.index + text.length - 1],\n                url: `mailto:${text}`,\n            });\n        }\n    }\n\n    return result;\n}\n\nfunction parseUrlLink(source: string): LinkInfo[] {\n    const reWwwAutolink = new RegExp(`(www|https?://).${DOMAIN}${PATH}`, \"g\");\n    const result: LinkInfo[] = [];\n    let m;\n\n    while ((m = reWwwAutolink.exec(source))) {\n        const text = trimTrailingEntity(trimUnmatchedTrailingParens(m[0]));\n        const scheme = m[1] === \"www\" ? \"http://\" : \"\";\n        result.push({\n            text,\n            range: [m.index, m.index + text.length - 1],\n            url: `${scheme}${text}`,\n        });\n    }\n\n    return result;\n}\n\nfunction parseSciKiPageLink(source: string): LinkInfo[] {\n    const rePageLink = new RegExp(\"<@([A-Za-z0-9_-]+)>\", \"g\");\n    const result: LinkInfo[] = [];\n    let m;\n\n    while ((m = rePageLink.exec(source))) {\n        result.push({\n            text: m[1],\n            range: [m.index, m.index + m[0].length - 1],\n            url: route(\"wiki.show\", m[1]),\n        });\n    }\n\n    return result;\n}\n\nconst AutoLinksParser: AutolinkParser = (source: string) => {\n    return [\n        ...parseUrlLink(source),\n        ...parseEmailLink(source),\n        ...parseSciKiPageLink(source),\n    ].sort((a, b) => a.range[0] - b.range[0]);\n};\n\nexport default AutoLinksParser;\n","import React, { ReactNode, useContext, useRef } from \"react\";\nimport { Editor as TUIEditor } from \"@toast-ui/react-editor\";\n\n// @ts-ignore\nconst EditorRefContext = React.createContext<React.RefObject<TUIEditor>>();\n\nexport function useEditorRefContext(): React.RefObject<TUIEditor> {\n    return useContext<React.RefObject<TUIEditor>>(EditorRefContext);\n}\n\nconst EditorRefProvider: React.FC = ({\n    children,\n}: {\n    children?: ReactNode;\n}) => {\n    const ref = useRef<TUIEditor>(null);\n\n    return (\n        <EditorRefContext.Provider value={ref}>\n            {children}\n        </EditorRefContext.Provider>\n    );\n};\n\nexport default EditorRefProvider;\n","// @ts-nocheck\nimport React from \"react\";\nimport mermaid from \"mermaid\";\nimport katex from \"katex\";\nimport TUIEditorObject from \"@toast-ui/editor\";\nimport { Editor as TUIEditor } from \"@toast-ui/react-editor\";\nimport colorSyntax from \"@toast-ui/editor-plugin-color-syntax\";\nimport codeSyntaxHighlight from \"@toast-ui/editor-plugin-code-syntax-highlight\";\nimport tableMergedCell from \"@toast-ui/editor-plugin-table-merged-cell\";\nimport hljs from \"highlight.js\";\nimport jv from \"w-jsonview-tree\";\nimport \"codemirror/lib/codemirror.css\";\nimport \"@toast-ui/editor/dist/toastui-editor.css\";\nimport \"tui-color-picker/dist/tui-color-picker.css\";\nimport \"highlight.js/styles/github.css\";\nimport \"katex/dist/katex.min.css\";\nimport PluginInfo = toastui.PluginInfo;\nimport route from \"ziggy-js\";\nimport AutoLinksParser from \"./AutoLinksParser\";\nimport { useEditorRefContext } from \"../../Contexts/EditorRefProvider\";\nimport TextToken = toastui.TextToken;\n\ninterface Props {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction katexPlugin(editor: TUIEditorObject) {\n    const katexPluginReplacer = (codeBlockContent: string) => {\n        const html = katex.renderToString(codeBlockContent, {\n            throwOnError: false,\n        });\n\n        return `<div>${html}</div>`;\n    };\n\n    editor.setCodeBlockLanguages([\"KaTeX\"]);\n    const { codeBlockManager } = Object.getPrototypeOf(editor).constructor;\n    codeBlockManager.setReplacer(\"KaTeX\", katexPluginReplacer);\n}\n\nfunction mermaidPlugin(editor: TUIEditorObject) {\n    const mermaidPluginReplacer = (codeBlockContent: string) => {\n        const randomId = `mermaid-${Math.random().toString(36).substr(2, 10)}`;\n        try {\n            const svg = mermaid.render(randomId, codeBlockContent);\n            return `<div>${svg}</div>`;\n        } catch (e) {\n            document.querySelector(`#d${randomId}`)?.remove();\n            return `<div class=\"text-danger\">Error: ${e.message}</div>`;\n        }\n    };\n\n    editor.setCodeBlockLanguages([\"mermaid\"]);\n    const { codeBlockManager } = Object.getPrototypeOf(editor).constructor;\n    codeBlockManager.setReplacer(\"mermaid\", mermaidPluginReplacer);\n}\n\nfunction scikiPlugin(editor: TUIEditorObject) {\n    const scikiPluginReplacer = (codeBlockContent: string) => {\n        const randomId = `sciki-${Math.random().toString(36).substr(2, 10)}`;\n        try {\n            const jsonData = JSON.parse(codeBlockContent);\n            setTimeout(() => {\n                const container = document.querySelector(`#${randomId}`);\n                try {\n                    jv(jsonData, container, { expanded: true });\n                } catch (e) {\n                    container.innerHTML = `<div class=\"text-danger\">Error: ${e.message}</div>`;\n                }\n            }, 0);\n            return `<div><strong>SciKi Component:</strong><div id=\"${randomId}\"></div></div>`;\n        } catch (e) {\n            return `<div class=\"text-danger\">Error: ${e.message}</div>`;\n        }\n    };\n\n    editor.setCodeBlockLanguages([\"SciKi\"]);\n    const { codeBlockManager } = Object.getPrototypeOf(editor).constructor;\n    codeBlockManager.setReplacer(\"SciKi\", scikiPluginReplacer);\n}\n\nconst ADD_NOTE_POPUP_CONTENT = `\n    <label for=\"ref\">Identifier</label>\n    <input name=\"ref\" type=\"text\" class=\"te-ref-input\" />\n    <label for=\"noteText\">Text</label>\n    <input name=\"noteText\" type=\"text\" class=\"te-note-text-input\" />\n    <div class=\"te-button-section\">\n        <button type=\"button\" class=\"te-ok-button\" style=\"width: auto; padding: 0px 14px 0px 15px; height: 28px;\">OK</button>\n        <button type=\"button\" class=\"te-close-button\" style=\"width: auto; padding: 0px 14px 0px 15px; height: 28px;\">Cancel</button>\n    </div>\n`;\n\nconst scikiExtendedMarkdownPlugin: PluginInfo = {\n    pluginFn(editor) {\n        editor.eventManager.addEventType(\"clickAddTOC\");\n        editor.eventManager.listen(\"clickAddTOC\", function () {\n            editor.insertText(\"[TOC]\");\n        });\n        editor\n            .getUI()\n            .getToolbar()\n            .addItem({\n                type: \"button\",\n                options: {\n                    className: \"addTOC\",\n                    event: \"clickAddTOC\",\n                    tooltip: \"Add table of content\",\n                    text: \"T\",\n                    style: \"background: none; color: black; font-weight: bold\",\n                },\n            });\n        //@ts-ignore\n        const popup = editor.getUI().createPopup({\n            header: true,\n            title: \"Add note/citation\",\n            content: ADD_NOTE_POPUP_CONTENT,\n            className: \"tui-popup-add-note tui-editor-popup\",\n            modal: false,\n            target: editor.getUI().getToolbar().el,\n            css: {\n                width: \"auto\",\n                position: \"absolute\",\n            },\n        });\n        editor.eventManager.addEventType(\"clickAddNoteButton\");\n        editor.eventManager.listen(\"clickAddNoteButton\", function () {\n            if (popup.isShow()) {\n                popup.hide();\n                return;\n            }\n            editor.eventManager.emit(\"closeAllPopup\");\n            popup.show();\n        });\n        const refTextBox = popup.el.querySelector(\".te-ref-input\");\n        const noteTextBox = popup.el.querySelector(\".te-note-text-input\");\n        editor.addCommand(\"markdown\", {\n            name: \"add_note\",\n            exec(mde, ref, note) {\n                const cm = mde.getEditor();\n                const oldCursor = cm.getCursor();\n                editor.moveCursorToEnd();\n                editor.insertText(`\\n[^${ref}]: ${note}`);\n                cm.setCursor(oldCursor);\n            },\n        });\n        popup.el\n            .querySelector(\".te-close-button\")\n            .addEventListener(\"click\", () => {\n                refTextBox.value = \"\";\n                noteTextBox.value = \"\";\n                popup.hide();\n            });\n        popup.el\n            .querySelector(\".te-ok-button\")\n            .addEventListener(\"click\", () => {\n                if (refTextBox.value != \"\") {\n                    editor.insertText(`[^${refTextBox.value}]`);\n                    if (noteTextBox.value != \"\") {\n                        editor.exec(\n                            \"add_note\",\n                            refTextBox.value,\n                            noteTextBox.value\n                        );\n                    }\n                    refTextBox.value = \"\";\n                    noteTextBox.value = \"\";\n                }\n                popup.hide();\n            });\n        editor\n            .getUI()\n            .getToolbar()\n            .addItem({\n                type: \"button\",\n                options: {\n                    className: \"addNote\",\n                    event: \"clickAddNoteButton\",\n                    tooltip: \"Add note/citation\",\n                    text: \"N\",\n                    style: \"background: none; color: black; font-weight: bold\",\n                },\n            });\n        return;\n    },\n    renderer: {\n        codeBlock(node, { origin }) {\n            const parsed = origin();\n            if (node.info !== \"SciKiMedia\") {\n                return parsed;\n            }\n            if (parsed.length === 5) {\n                const textNode = parsed[2] as TextToken;\n                try {\n                    const jsonData = JSON.parse(textNode.content);\n                    return [\n                        {\n                            type: \"openTag\",\n                            tagName: \"div\",\n                            classNames: [\n                                \"figure\",\n                                jsonData.position === \"right\"\n                                    ? \"fig_right\"\n                                    : \"fig_left\",\n                            ],\n                            attributes: parsed[0].attributes,\n                        },\n                        {\n                            type: \"html\",\n                            content: `<div class=\"fig_container\"><a href=\"${route(\n                                \"page.media.show\",\n                                jsonData.media\n                            )}\" class=\"fig\"><img src=\"${route(\n                                \"page.media.image\",\n                                jsonData.media\n                            )}\" alt=\"${\n                                jsonData.caption\n                            }\"></a><div class=\"fig_caption\">${\n                                jsonData.caption\n                            }</div></div>`,\n                        },\n                        {\n                            type: \"closeTag\",\n                            tagName: \"div\",\n                        },\n                    ];\n                } catch (e) {\n                    return [\n                        {\n                            type: \"openTag\",\n                            tagName: \"div\",\n                            classNames: [\"text-danger\"],\n                            attributes: parsed[0].attributes,\n                        },\n                        {\n                            type: \"text\",\n                            content: `Error: ${e.message}`,\n                        },\n                        {\n                            type: \"closeTag\",\n                            tagName: \"div\",\n                        },\n                    ];\n                }\n            }\n            return parsed;\n        },\n    },\n    parser: {\n        image(node, { entering }) {\n            if (entering) {\n                const { destination } = node as { destination: string };\n                if (destination.startsWith(\"#\") && destination.endsWith(\"#\")) {\n                    node.destination = route(\n                        \"page.media.image\",\n                        destination.substr(1, destination.length - 2)\n                    );\n                    node.orgDestination = destination;\n                }\n            }\n        },\n        link(node, { entering }) {\n            if (entering) {\n                const { destination } = node;\n                if (destination.startsWith(\"@\")) {\n                    node.destination = route(\n                        \"wiki.show\",\n                        destination.substr(1)\n                    );\n                    node.orgDestination = destination;\n                }\n            }\n        },\n    },\n};\n\nconst Editor: React.FC<Props> = ({ value, onChange }: Props) => {\n    const editorRef = useEditorRefContext();\n\n    return (\n        <>\n            <TUIEditor\n                initialValue={value}\n                previewStyle=\"tab\"\n                height=\"600px\"\n                initialEditType=\"markdown\"\n                useCommandShortcut={true}\n                usageStatistics={false}\n                hideModeSwitch={true}\n                extendedAutolinks={AutoLinksParser}\n                onChange={() =>\n                    onChange(\n                        editorRef.current?.getInstance().getMarkdown() ?? \"\"\n                    )\n                }\n                plugins={[\n                    scikiPlugin,\n                    tableMergedCell,\n                    mermaidPlugin,\n                    colorSyntax,\n                    katexPlugin,\n                    [codeSyntaxHighlight, { hljs }],\n                    scikiExtendedMarkdownPlugin,\n                ]}\n                ref={editorRef}\n            />\n        </>\n    );\n};\n\nexport default Editor;\n","import api from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[7].oneOf[1].use[1]!../../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[7].oneOf[1].use[2]!./MediaManager.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React, { useRef, useState } from \"react\";\nimport {\n    Button,\n    Card,\n    CardBody,\n    CardHeader,\n    Col,\n    FormFeedback,\n    FormGroup,\n    Input,\n    Label,\n    Modal,\n    Row,\n    UncontrolledTooltip,\n} from \"reactstrap\";\nimport Uppy from \"@uppy/core\";\nimport Xhr from \"@uppy/xhr-upload\";\nimport ImageEditor from \"@uppy/image-editor\";\nimport { DashboardModal, useUppy } from \"@uppy/react\";\nimport route from \"ziggy-js\";\nimport Cookies from \"browser-cookies\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport \"@uppy/core/dist/style.min.css\";\nimport \"@uppy/dashboard/dist/style.min.css\";\nimport \"@uppy/image-editor/dist/style.min.css\";\nimport \"../../../css/Components/Wiki/MediaManager.css\";\nimport axios from \"axios\";\nimport classNames from \"classnames\";\n\nexport interface Media {\n    id: number;\n    uuid: string;\n    title: string;\n    legend: string;\n    url: string;\n    thumbs: {\n        small: string;\n        large: string;\n    };\n    srcset: string;\n}\n\ninterface Props {\n    currentPageSlug: string;\n    media: Record<string, Media>;\n    enableFeatured?: boolean;\n    featuredId?: number;\n    deletedMedia: string[];\n    onMediaSelect: (media: Media) => void;\n    onFeaturedSelect?: (media: Media) => void;\n    onMediaUpdate: (media: Media) => void;\n    onMediaUpload: (newMedia: Media) => void;\n    onMediaDelete: (uuid: string) => void;\n}\n\ninterface EditState {\n    open: boolean;\n    media?: Media;\n    processing?: boolean;\n    errors?: {\n        title?: string[];\n        legend?: string[];\n    };\n}\n\nconst MediaManager: React.FC<Props> = ({\n    currentPageSlug,\n    media,\n    enableFeatured = false,\n    featuredId,\n    deletedMedia,\n    onMediaUpload,\n    onMediaUpdate,\n    onMediaSelect,\n    onFeaturedSelect,\n    onMediaDelete,\n}: Props) => {\n    const isFeaturedEnabled = enableFeatured && onFeaturedSelect;\n    const titleRef = useRef<HTMLInputElement | HTMLTextAreaElement>(null);\n    const legendRef = useRef<HTMLInputElement | HTMLTextAreaElement>(null);\n    const uppy = useUppy(() => {\n        const instance = new Uppy.Uppy({\n            restrictions: {\n                allowedFileTypes: [\"image/*\"],\n            },\n        });\n        instance.use(Xhr, {\n            fieldName: \"file\",\n            endpoint: route(\"page.media.upload\", currentPageSlug),\n            headers: {\n                \"X-XSRF-TOKEN\": Cookies.get(\"XSRF-TOKEN\"),\n                accept: \"application/json\",\n            },\n            getResponseError(\n                responseText: string,\n                response: XMLHttpRequest\n            ): Error {\n                const jsonResponse = JSON.parse(responseText);\n                if (\n                    response.status === 422 &&\n                    jsonResponse.errors &&\n                    jsonResponse.errors.file\n                ) {\n                    if (\n                        Array.isArray(jsonResponse.errors.file) &&\n                        jsonResponse.errors.file[0]\n                    ) {\n                        return new Error(\n                            jsonResponse.errors.file[0] || \"Unknown error\"\n                        );\n                    }\n                    return new Error(\n                        jsonResponse.errors.file || \"Unknown error\"\n                    );\n                }\n                return new Error(jsonResponse?.message || \"Unknown error\");\n            },\n        });\n        instance.use(ImageEditor, {\n            quality: 0.8,\n        });\n        instance.on(\"upload-success\", (_, response) => {\n            onMediaUpload(response.body.media as Media);\n        });\n        return instance;\n    });\n    const [uploadOpen, setUploadOpen] = useState(false);\n    const [editState, setEditState] = useState({ open: false } as EditState);\n    const toggleEdit = () =>\n        setEditState((prevState) => ({\n            ...prevState,\n            open: !prevState.open,\n        }));\n    const setProcessing = (processing: boolean) =>\n        setEditState((prevState) => ({\n            ...prevState,\n            processing,\n        }));\n    const saveMedia = async (e: React.MouseEvent<HTMLButtonElement>) => {\n        e.preventDefault();\n        setProcessing(true);\n        try {\n            setEditState({ open: false });\n            const result = await axios.put(\n                route(\"page.media.update\", [\n                    currentPageSlug,\n                    editState.media?.uuid || \"\",\n                ]),\n                {\n                    title: titleRef?.current?.value,\n                    legend: legendRef?.current?.value,\n                }\n            );\n            const media: Media = result.data.media;\n            onMediaUpdate(media);\n        } catch (e) {\n            if (e.response.data.errors) {\n                setEditState((prevState) => ({\n                    ...prevState,\n                    errors: e.response.data.errors,\n                }));\n            }\n        }\n        setProcessing(false);\n    };\n\n    return (\n        <>\n            <Row>\n                <Col className=\"mb-5 mb-xl-2\" md=\"12\">\n                    <Card className=\"bg-gradient-dark shadow\">\n                        <CardHeader className=\"bg-transparent\">\n                            <Row className=\"justify-content-between align-items-center\">\n                                <div className=\"col\">\n                                    <h6 className=\"text-uppercase text-light ls-1 mb-1\">\n                                        Page Media\n                                    </h6>\n                                </div>\n                                <div className=\"col d-flex justify-content-end\">\n                                    <a\n                                        className=\"btn btn-outline-light btn-sm\"\n                                        href=\"#\"\n                                        onClick={(e) => {\n                                            e.preventDefault();\n                                            setUploadOpen(true);\n                                        }}\n                                    >\n                                        <i className=\"fas fa-plus mr-2\" />\n                                        Add media\n                                    </a>\n                                </div>\n                            </Row>\n                        </CardHeader>\n                        <CardBody>\n                            <div\n                                className=\"MediaManagerList overflow-auto\"\n                                style={{\n                                    maxHeight: \"200px\",\n                                }}\n                            >\n                                {Object.values(media)\n                                    .filter(\n                                        (m) => !deletedMedia.includes(m.uuid)\n                                    )\n                                    .map((m) => (\n                                        <div key={m.uuid}>\n                                            <div\n                                                className=\"PreviewContainer\"\n                                                style={{\n                                                    background: `url('${m.thumbs.large}') no-repeat center center`,\n                                                }}\n                                                onClick={() => onMediaSelect(m)}\n                                            >\n                                                <div className=\"text-green opacity-10\">\n                                                    <i className=\"fas fa-2x fa-check\" />\n                                                </div>\n                                            </div>\n                                            <div className=\"TitleContainer\">\n                                                <div\n                                                    className=\"text-light\"\n                                                    title={m.title}\n                                                >\n                                                    {m.title}\n                                                </div>\n                                                <div>\n                                                    <CopyToClipboard\n                                                        text={m.uuid}\n                                                    >\n                                                        <a\n                                                            id={`CopyToClipboardMediaTooltip${m.uuid}`}\n                                                            href=\"#\"\n                                                            onClick={(e) =>\n                                                                e.preventDefault()\n                                                            }\n                                                            title=\"Copy Id to Clipboard\"\n                                                        >\n                                                            <i className=\"fas fa-clipboard\" />\n                                                        </a>\n                                                    </CopyToClipboard>\n                                                    <UncontrolledTooltip\n                                                        placement=\"auto\"\n                                                        target={`CopyToClipboardMediaTooltip${m.uuid}`}\n                                                    >\n                                                        Copy Id to Clipboard\n                                                    </UncontrolledTooltip>\n                                                </div>\n                                                {isFeaturedEnabled && (\n                                                    <div>\n                                                        <a\n                                                            id={`FeatureMediaTooltip${m.uuid}`}\n                                                            href=\"#\"\n                                                            onClick={(e) => {\n                                                                e.preventDefault();\n                                                                if (\n                                                                    onFeaturedSelect\n                                                                )\n                                                                    onFeaturedSelect(\n                                                                        m\n                                                                    );\n                                                            }}\n                                                            className=\"text-danger\"\n                                                            title=\"Mark as featured\"\n                                                        >\n                                                            {featuredId ===\n                                                            m.id ? (\n                                                                <i className=\"fas fa-star\" />\n                                                            ) : (\n                                                                <i className=\"far fa-star\" />\n                                                            )}\n                                                        </a>\n                                                        <UncontrolledTooltip\n                                                            placement=\"auto\"\n                                                            target={`FeatureMediaTooltip${m.uuid}`}\n                                                        >\n                                                            Mark as featured\n                                                        </UncontrolledTooltip>\n                                                    </div>\n                                                )}\n                                                <div>\n                                                    <a\n                                                        id={`EditMediaTooltip${m.uuid}`}\n                                                        href=\"#\"\n                                                        onClick={(e) => {\n                                                            e.preventDefault();\n                                                            setEditState({\n                                                                open: true,\n                                                                media: m,\n                                                            });\n                                                        }}\n                                                        title=\"Edit media\"\n                                                    >\n                                                        <i className=\"fas fa-pencil-alt\" />\n                                                    </a>\n                                                    <UncontrolledTooltip\n                                                        placement=\"auto\"\n                                                        target={`EditMediaTooltip${m.uuid}`}\n                                                    >\n                                                        Edit Title and Legend\n                                                    </UncontrolledTooltip>\n                                                </div>\n                                                <div>\n                                                    <a\n                                                        id={`DeleteMediaTooltip${m.uuid}`}\n                                                        href=\"#\"\n                                                        onClick={(e) => {\n                                                            e.preventDefault();\n                                                            onMediaDelete(\n                                                                m.uuid\n                                                            );\n                                                        }}\n                                                        className=\"text-danger\"\n                                                        title=\"Delete media\"\n                                                    >\n                                                        <i className=\"fas fa-trash\" />\n                                                    </a>\n                                                    <UncontrolledTooltip\n                                                        placement=\"auto\"\n                                                        target={`DeleteMediaTooltip${m.uuid}`}\n                                                    >\n                                                        Delete media\n                                                    </UncontrolledTooltip>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                            </div>\n                        </CardBody>\n                    </Card>\n                </Col>\n            </Row>\n            <DashboardModal\n                uppy={uppy}\n                closeModalOnClickOutside\n                open={uploadOpen}\n                onRequestClose={() => setUploadOpen(false)}\n                fileManagerSelectionType=\"files\"\n                theme=\"dark\"\n                plugins={[\"ImageEditor\"]}\n            />\n            <Modal\n                className=\"modal-dialog-centered\"\n                isOpen={editState.open}\n                toggle={toggleEdit}\n            >\n                <div className=\"modal-header\">\n                    <h5 className=\"modal-title\" id=\"exampleModalLabel\">\n                        Edit {editState.media?.title}\n                    </h5>\n                    <button\n                        aria-label=\"Close\"\n                        className=\"close\"\n                        data-dismiss=\"modal\"\n                        type=\"button\"\n                        onClick={toggleEdit}\n                    >\n                        <span aria-hidden={true}>×</span>\n                    </button>\n                </div>\n                <div className=\"modal-body\">\n                    <FormGroup\n                        className={classNames({\n                            \"has-danger\":\n                                editState.errors?.title &&\n                                !!editState.errors?.title[0],\n                        })}\n                    >\n                        <Label for=\"mediaTitle\">Title</Label>\n                        <Input\n                            name=\"mediaTitle\"\n                            placeholder=\"Insert title here\"\n                            type=\"text\"\n                            innerRef={titleRef}\n                            invalid={\n                                editState.errors?.title &&\n                                !!editState.errors?.title[0]\n                            }\n                            defaultValue={editState.media?.title}\n                        />\n                        <FormFeedback tag=\"span\" className=\"invalid-feedback\">\n                            <strong>\n                                {editState.errors?.title &&\n                                    editState.errors?.title[0]}\n                            </strong>\n                        </FormFeedback>\n                    </FormGroup>\n                    <FormGroup\n                        className={classNames({\n                            \"has-danger\":\n                                editState.errors?.legend &&\n                                !!editState.errors?.legend[0],\n                        })}\n                    >\n                        <Label for=\"mediaLegend\">Legend</Label>\n                        <Input\n                            name=\"mediaLegend\"\n                            placeholder=\"Insert the legend here\"\n                            type=\"textarea\"\n                            innerRef={legendRef}\n                            invalid={\n                                editState.errors?.legend &&\n                                !!editState.errors?.legend[0]\n                            }\n                            defaultValue={editState.media?.legend}\n                        />\n                        <FormFeedback tag=\"span\" className=\"invalid-feedback\">\n                            <strong>\n                                {editState.errors?.legend &&\n                                    editState.errors?.legend[0]}\n                            </strong>\n                        </FormFeedback>\n                    </FormGroup>\n                </div>\n                <div className=\"modal-footer\">\n                    <Button\n                        color=\"secondary\"\n                        data-dismiss=\"modal\"\n                        type=\"button\"\n                        onClick={toggleEdit}\n                    >\n                        Close\n                    </Button>\n                    <Button\n                        color=\"primary\"\n                        type=\"button\"\n                        disabled={editState.processing}\n                        onClick={saveMedia}\n                    >\n                        <i\n                            className={\n                                editState.processing\n                                    ? \"fas fa-spinner fa-spin mr-2\"\n                                    : \"fa fa-save mr-2\"\n                            }\n                        />\n                        Save changes\n                    </Button>\n                </div>\n            </Modal>\n        </>\n    );\n};\n\nexport default MediaManager;\n","import React from \"react\";\nimport Header from \"../../Components/Layout/Headers/DefaultHeader\";\nimport {\n    Card,\n    CardBody,\n    CardHeader,\n    Col,\n    Container,\n    Form,\n    FormFeedback,\n    FormGroup,\n    Input,\n    Label,\n    Nav,\n    NavItem,\n    NavLink,\n    Row,\n} from \"reactstrap\";\nimport { useForm } from \"@inertiajs/inertia-react\";\nimport classNames from \"classnames\";\nimport Editor from \"../../Components/Wiki/Editor\";\nimport MediaManager, { Media } from \"../../Components/Wiki/MediaManager\";\nimport EditorRefProvider, {\n    useEditorRefContext,\n} from \"../../Contexts/EditorRefProvider\";\nimport route from \"ziggy-js\";\nimport { Inertia } from \"@inertiajs/inertia\";\n\nimport \"@uppy/core/dist/style.min.css\";\nimport \"@uppy/dashboard/dist/style.min.css\";\nimport \"@uppy/image-editor/dist/style.min.css\";\nimport \"react-bootstrap-typeahead/css/Typeahead.css\";\nimport TagsManagerCard from \"../../Components/TagsManagerCard\";\n\ninterface Props {\n    page: {\n        slug: string;\n        title: string;\n        content: string;\n        featured_image_id?: number;\n        draft: boolean;\n    };\n    formatted_tags: string[];\n    media: Record<string, Media>;\n}\n\nconst Index: React.FC<Props> = ({\n    page: { slug, title, content, draft, featured_image_id },\n    formatted_tags: tags,\n    media,\n}: Props) => {\n    const editorRef = useEditorRefContext();\n    const { data, setData, errors, put, processing } = useForm({\n        title,\n        content,\n        tags,\n        media,\n        featured_image_id,\n        deletedMedia: [] as string[],\n    });\n\n    const submitForm = async (\n        e:\n            | React.MouseEvent<HTMLAnchorElement>\n            | React.FormEvent<HTMLFormElement>\n    ) => {\n        e.preventDefault();\n        await put(route(\"page.update\", slug));\n    };\n\n    return (\n        <Form onSubmit={submitForm}>\n            <Header\n                title={\n                    <FormGroup\n                        className={classNames(\"align-items-start\", {\n                            \"has-danger\": !!errors.title,\n                        })}\n                        row\n                    >\n                        <Label\n                            for=\"page-title\"\n                            sm=\"auto\"\n                            className=\"text-light p-0 m-0\"\n                            style={{ fontSize: \"0.7em\" }}\n                        >\n                            Title:\n                        </Label>\n                        <Col sm=\"auto\" className=\"flex-grow-1\">\n                            <Input\n                                className=\"form-control-alternative bg-light text-dark\"\n                                type=\"text\"\n                                invalid={!!errors.title}\n                                value={data.title}\n                                onChange={(e) =>\n                                    setData(\"title\", e.target.value)\n                                }\n                            />\n                            <FormFeedback className=\"invalid-feedback text-sm\">\n                                <strong>{errors.title}</strong>\n                            </FormFeedback>\n                        </Col>\n                    </FormGroup>\n                }\n            />\n            <Container className=\"mt--7\" fluid>\n                <Row className=\"mb-2\">\n                    <Col lg={12} className=\"text-right\">\n                        <Nav\n                            className=\"nav-fill flex-column-reverse flex-sm-row-reverse\"\n                            pills\n                        >\n                            {draft && (\n                                <NavItem className=\"ml-2 flex-grow-0\">\n                                    <NavLink\n                                        className=\"mb-sm-3 mb-md-0 text-green\"\n                                        onClick={(e) => {\n                                            e.preventDefault();\n                                            return Inertia.put(\n                                                route(\"page.publish\", slug)\n                                            );\n                                        }}\n                                        disabled={processing}\n                                        href=\"#\"\n                                    >\n                                        <i className=\"fas fa-upload mr-2\" />\n                                        Publish\n                                    </NavLink>\n                                </NavItem>\n                            )}\n                            {!draft && (\n                                <NavItem className=\"ml-2 flex-grow-0\">\n                                    <NavLink\n                                        className=\"mb-sm-3 mb-md-0 text-orange\"\n                                        onClick={(e) => {\n                                            e.preventDefault();\n                                            return Inertia.put(\n                                                route(\"page.draft\", slug)\n                                            );\n                                        }}\n                                        disabled={processing}\n                                        href=\"#\"\n                                    >\n                                        <i className=\"fas fa-pencil-alt mr-2\" />\n                                        Revert to Draft\n                                    </NavLink>\n                                </NavItem>\n                            )}\n                            <NavItem className=\"flex-grow-0\">\n                                <NavLink\n                                    className=\"mb-sm-3 mb-md-0\"\n                                    onClick={submitForm}\n                                    disabled={processing}\n                                    href=\"#\"\n                                >\n                                    <i className=\"fas fa-save mr-2\" />\n                                    Save\n                                </NavLink>\n                            </NavItem>\n                        </Nav>\n                    </Col>\n                </Row>\n                <Row>\n                    <Col className=\"mb-5 mb-xl-2\" xl=\"8\">\n                        <Card className=\"shadow\">\n                            <CardHeader className=\"bg-transparent\">\n                                <h6 className=\"text-uppercase text-dark ls-1 mb-1\">\n                                    Content\n                                </h6>\n                            </CardHeader>\n                            <CardBody>\n                                <Editor\n                                    value={content}\n                                    onChange={(newContent) =>\n                                        setData(\"content\", newContent)\n                                    }\n                                />\n                                {!!errors.content && (\n                                    <div className=\"invalid-feedback d-block\">\n                                        <strong>{errors.content}</strong>\n                                    </div>\n                                )}\n                            </CardBody>\n                        </Card>\n                    </Col>\n                    <Col className=\"mb-5 mb-xl-2\" xl=\"4\">\n                        <TagsManagerCard\n                            tags={data.tags}\n                            onAddTag={(newTag) =>\n                                setData((previousData) => ({\n                                    ...previousData,\n                                    tags: [\n                                        ...previousData.tags.filter(\n                                            (t) => t !== newTag\n                                        ),\n                                        newTag,\n                                    ],\n                                }))\n                            }\n                            onDeleteTag={(deletedTag) =>\n                                setData((previousData) => ({\n                                    ...previousData,\n                                    tags: previousData.tags.filter(\n                                        (t) => t !== deletedTag\n                                    ),\n                                }))\n                            }\n                        />\n                    </Col>\n                </Row>\n                <MediaManager\n                    currentPageSlug={slug}\n                    media={data.media}\n                    deletedMedia={data.deletedMedia}\n                    onMediaSelect={(m) => {\n                        if (editorRef.current) {\n                            const mediaText = `\\n\\`\\`\\`SciKiMedia\n{\n    \"media\": \"${m.uuid}\",\n    \"position\": \"left\",\n    \"caption\": \"${m.title}\"\n}\n\\`\\`\\`\\n`;\n                            editorRef.current\n                                .getInstance()\n                                .insertText(mediaText);\n                        }\n                    }}\n                    onMediaUpdate={(updatedMedia) => {\n                        setData((previousData) => {\n                            const tmpData = {\n                                ...previousData,\n                                media: {\n                                    ...previousData.media,\n                                },\n                            };\n                            tmpData.media[updatedMedia.uuid] = updatedMedia;\n                            return tmpData;\n                        });\n                    }}\n                    onMediaUpload={(newMedia) =>\n                        setData((previousData) => ({\n                            ...previousData,\n                            media: {\n                                ...previousData.media,\n                                [newMedia.uuid]: newMedia,\n                            },\n                        }))\n                    }\n                    onMediaDelete={(uuid) =>\n                        setData((previousData) => ({\n                            ...previousData,\n                            deletedMedia: [...previousData.deletedMedia, uuid],\n                        }))\n                    }\n                    enableFeatured\n                    featuredId={data.featured_image_id}\n                    onFeaturedSelect={(m) => setData(\"featured_image_id\", m.id)}\n                />\n                <Row>\n                    <Col>\n                        {!!errors.deletedMedia && (\n                            <div className=\"invalid-feedback d-block\">\n                                <strong>{errors.deletedMedia}</strong>\n                            </div>\n                        )}\n                    </Col>\n                </Row>\n            </Container>\n        </Form>\n    );\n};\n\nconst IndexWithContext: React.FC<Props> = (props) => (\n    <EditorRefProvider>\n        <Index {...props} />\n    </EditorRefProvider>\n);\n\nexport default IndexWithContext;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"div.MediaManagerList{display:grid;grid-gap:40px;grid-template-columns:repeat(auto-fit,minmax(128px,1fr));grid-auto-rows:128px}div.MediaManagerList>div{display:flex;flex-direction:column}div.MediaManagerList>div>div.PreviewContainer{flex-grow:1;display:flex;align-items:center;justify-content:center;background-size:contain!important;cursor:pointer}div.MediaManagerList>div>div.PreviewContainer>div{display:none}div.MediaManagerList>div>div.PreviewContainer:hover{opacity:.5}div.MediaManagerList>div>div.PreviewContainer:hover>div{display:block!important}div.MediaManagerList>div>div.TitleContainer{display:flex;flex-direction:row;font-size:.75rem!important}div.MediaManagerList>div>div.TitleContainer>div:first-child{flex-grow:1;overflow:hidden;text-overflow:ellipsis;text-align:center;white-space:nowrap}div.MediaManagerList>div>div.TitleContainer>div:nth-child(2){margin-left:.5rem;margin-right:.5rem}div.MediaManagerList>div>div.TitleContainer>div:nth-child(3),div.MediaManagerList>div>div.TitleContainer>div:nth-child(4){margin-right:.5rem}\", \"\",{\"version\":3,\"sources\":[\"webpack://./resources/css/Components/Wiki/MediaManager.css\"],\"names\":[],\"mappings\":\"AAAA,qBACI,YAAa,CACb,aAAc,CACd,wDAA2D,CAC3D,oBACJ,CAEA,yBACI,YAAa,CACb,qBACJ,CAEA,8CACI,WAAY,CACZ,YAAa,CAEb,kBAAmB,CACnB,sBAAuB,CACvB,iCAAmC,CACnC,cACJ,CAEA,kDACI,YACJ,CAEA,oDACI,UACJ,CAEA,wDACI,uBACJ,CAEA,4CACI,YAAa,CACb,kBAAmB,CACnB,0BACJ,CAEA,4DACI,WAAY,CACZ,eAAgB,CAChB,sBAAuB,CACvB,iBAAkB,CAClB,kBACJ,CAEA,6DACI,iBAAmB,CACnB,kBACJ,CAMA,0HACI,kBACJ\",\"sourcesContent\":[\"div.MediaManagerList {\\n    display: grid;\\n    grid-gap: 40px;\\n    grid-template-columns: repeat(auto-fit, minmax(128px, 1fr));\\n    grid-auto-rows: 128px;\\n}\\n\\ndiv.MediaManagerList > div {\\n    display: flex;\\n    flex-direction: column;\\n}\\n\\ndiv.MediaManagerList > div > div.PreviewContainer {\\n    flex-grow: 1;\\n    display: flex;\\n    -ms-flex-align: center;\\n    align-items: center;\\n    justify-content: center;\\n    background-size: contain !important;\\n    cursor: pointer;\\n}\\n\\ndiv.MediaManagerList > div > div.PreviewContainer > div {\\n    display: none;\\n}\\n\\ndiv.MediaManagerList > div > div.PreviewContainer:hover {\\n    opacity: 0.5;\\n}\\n\\ndiv.MediaManagerList > div > div.PreviewContainer:hover > div {\\n    display: block !important;\\n}\\n\\ndiv.MediaManagerList > div > div.TitleContainer {\\n    display: flex;\\n    flex-direction: row;\\n    font-size: 0.75rem !important;\\n}\\n\\ndiv.MediaManagerList > div > div.TitleContainer > div:first-child {\\n    flex-grow: 1;\\n    overflow: hidden;\\n    text-overflow: ellipsis;\\n    text-align: center;\\n    white-space: nowrap;\\n}\\n\\ndiv.MediaManagerList > div > div.TitleContainer > div:nth-child(2) {\\n    margin-left: 0.5rem;\\n    margin-right: 0.5rem;\\n}\\n\\ndiv.MediaManagerList > div > div.TitleContainer > div:nth-child(3) {\\n    margin-right: 0.5rem;\\n}\\n\\ndiv.MediaManagerList > div > div.TitleContainer > div:nth-child(4) {\\n    margin-right: 0.5rem;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var map = {\n\t\"./locale\": 89234,\n\t\"./locale.js\": 89234\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 11748;"],"sourceRoot":""}